#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Verificando cÃ³digo antes do commit...\n"

# Executar lint
echo "ğŸ“ Lint..."
pnpm lint || {
  echo "\nâŒ Erro no lint. Corrija os erros antes de commitar."
  exit 1
}

# Executar typecheck
echo "\nğŸ”· TypeScript..."
pnpm typecheck || {
  echo "\nâŒ Erro no typecheck. Corrija os erros de tipo antes de commitar."
  exit 1
}

# Executar scan de seguranÃ§a
if [ -f ".zoryon/security/scan.mjs" ]; then
  echo "\nğŸ”’ SeguranÃ§a..."
  node .zoryon/security/scan.mjs || {
    echo "\nâŒ Problemas de seguranÃ§a detectados. Remova secrets antes de commitar."
    exit 1
  }
fi

echo "\nâœ… Tudo certo! Prosseguindo com o commit...\n"

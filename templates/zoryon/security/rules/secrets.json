{
  "name": "Regras de Detecção de Secrets",
  "version": "1.0.0",
  "description": "Padrões para detectar secrets expostos no código",
  "rules": [
    {
      "id": "stripe-key",
      "name": "Chave Stripe",
      "pattern": "sk_(live|test)_[a-zA-Z0-9]{24,}",
      "severity": "critical",
      "message": "Chave secreta do Stripe detectada. Use variáveis de ambiente.",
      "fix": "Mova para STRIPE_SECRET_KEY no .env"
    },
    {
      "id": "clerk-key",
      "name": "Chave Clerk",
      "pattern": "sk_(live|test)_[a-zA-Z0-9]{20,}",
      "severity": "critical",
      "message": "Chave secreta do Clerk detectada. Use variáveis de ambiente.",
      "fix": "Mova para CLERK_SECRET_KEY no .env"
    },
    {
      "id": "supabase-jwt",
      "name": "JWT Supabase",
      "pattern": "eyJ[a-zA-Z0-9_-]+\\.eyJ[a-zA-Z0-9_-]+\\.[a-zA-Z0-9_-]+",
      "severity": "critical",
      "message": "Token JWT do Supabase detectado. Use variáveis de ambiente.",
      "fix": "Mova para SUPABASE_SERVICE_ROLE_KEY no .env"
    },
    {
      "id": "github-token",
      "name": "Token GitHub",
      "pattern": "gh[pousr]_[a-zA-Z0-9]{36,}",
      "severity": "critical",
      "message": "Token do GitHub detectado. Use variáveis de ambiente.",
      "fix": "Mova para GITHUB_TOKEN no .env"
    },
    {
      "id": "aws-key",
      "name": "Chave AWS",
      "pattern": "AKIA[0-9A-Z]{16}",
      "severity": "critical",
      "message": "Chave de acesso AWS detectada. Use variáveis de ambiente.",
      "fix": "Mova para AWS_ACCESS_KEY_ID no .env"
    },
    {
      "id": "private-key",
      "name": "Chave Privada",
      "pattern": "-----BEGIN (RSA |EC )?PRIVATE KEY-----",
      "severity": "critical",
      "message": "Chave privada detectada. Nunca commite chaves privadas.",
      "fix": "Remova o arquivo e adicione ao .gitignore"
    },
    {
      "id": "database-url",
      "name": "URL de Banco",
      "pattern": "(postgres|mysql|mongodb)://[^\\s]+",
      "severity": "high",
      "message": "URL de banco de dados detectada. Use variáveis de ambiente.",
      "fix": "Mova para DATABASE_URL no .env"
    },
    {
      "id": "generic-secret",
      "name": "Secret Genérico",
      "pattern": "(api_?key|api_?secret|secret_?key)\\s*[:=]\\s*['\"][^'\"]{16,}['\"]",
      "severity": "high",
      "message": "Possível secret detectado. Verifique se deve ser uma variável de ambiente.",
      "fix": "Mova para variável de ambiente apropriada"
    },
    {
      "id": "password-hardcoded",
      "name": "Senha Hardcoded",
      "pattern": "(password|senha|pwd)\\s*[:=]\\s*['\"][^'\"]{8,}['\"]",
      "severity": "high",
      "message": "Senha hardcoded detectada. Use variáveis de ambiente.",
      "fix": "Mova para variável de ambiente apropriada"
    }
  ]
}
